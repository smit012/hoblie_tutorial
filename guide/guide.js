/* ======================
   KIT CONFIG
====================== */

const kitConfig = {

 

pourseafoam: {
    title: "Seafoam Swirls",
    theme: {
      cardBg: "#86d1d4",
      buttonBg: "#ffffffff",
      buttonText: "#000000ff",
      // accent: "#86d1d4",
       buttonBorder: "#ffffffff",
    },
    slides: [

        {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/blue.png?v=1767175324"
     },

      {
        type: "video",
        title: "What‚Äôs inside the kit?",
        vimeo: "1150611082"
      },


      {
        type: "poll",
         title: " Quick Question",
        question: "How are you feeling right now?",
        options: ["üò¨ A little nervous", "üëÄ Very curious"]
      },

       {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/2_101bf155-fb01-44dd-948c-9f5f933fd45a.png?v=1767175324"
      },

       {
        type: "video",
        title: "Do‚Äôs and Don‚Äôts",
        vimeo: "1146128246"
      },
              {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/3_08b0f067-6d8e-4b0a-80d3-caa4f77070ec.png?v=1767175324"
     },


       {
        type: "video",
        title: " Dirty Pour Method",
        vimeo: "1146128092"
      },

      {
        type: "video",
        title: "Swirl Pour",
        vimeo: "1146128166"
      },

      {
        type: "video",
        title: "Swipe Pour Method",
        vimeo: "1146128197"
      },

      {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/4_996aa580-b8be-4115-97ac-dd0a03b54d10.png?v=1767175324"
     },


       {
        type: "video",
        title: "Dutch Pour Method",
        vimeo: "1146128121"
      },

      {
        type: "video",
        title: "Puddle Pour Method",
        vimeo: "1146128145"
      },

      
        {
        type: "video",
        title: "Flip Pour Method",
        vimeo: "1146128218"
      },
      

      {
        type: "poll",
        title: " Pick Your Favorite Method",
        question: "Which method will you try first?",
        options: ["Dirty Pour", "Dutch Pour", "Puddle Pour", "Swirl Pour", "Swipe Pour", "Flip Pour"]
      },

      {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/5_c613a68f-96a3-4d80-aec5-87f6939b8e90.png?v=1767175324"
     },

      {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/6_b21ea80b-21d5-469d-a438-46536feae5b8.png?v=1767175324"
     },
     
       {
        type: "video",
        title: "Seal Your Coasters",
        vimeo: "1146125857"
      },

      
      {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/7_533de713-c502-4709-bb83-321764aba6c5.png?v=1767175324"
     },

      {
        type: "review",
        title: "Your Thoughts",
        question: "How was this kit for you?"
      }
    ]
  },

  
poursunset: {
    title: "Seafoam Swirls",
    theme: {
      cardBg: "#8ac86a",
      buttonBg: "#ffffffff",
      buttonText: "#000000ff",
      // accent: "#86d1d4",
       buttonBorder: "#ffffffff",
    },
    slides: [

        {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/green.png?v=1767179531"
     },

      {
        type: "video",
        title: "What‚Äôs inside the kit?",
        vimeo: "1150611082"
      },


      {
        type: "poll",
         title: " Quick Question",
        question: "How are you feeling right now?",
        options: ["üò¨ A little nervous", "üëÄ Very curious"]
      },

       {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/9.png?v=1767179531"
      },

       {
        type: "video",
        title: "Do‚Äôs and Don‚Äôts",
        vimeo: "1146128246"
      },
              {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/10.png?v=1767179532"
     },


       {
        type: "video",
        title: " Dirty Pour Method",
        vimeo: "1146128092"
      },

      {
        type: "video",
        title: "Swirl Pour",
        vimeo: "1146128166"
      },

      {
        type: "video",
        title: "Swipe Pour Method",
        vimeo: "1146128197"
      },

      {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/11.png?v=1767179531"
     },


       {
        type: "video",
        title: "Dutch Pour Method",
        vimeo: "1146128121"
      },

      {
        type: "video",
        title: "Puddle Pour Method",
        vimeo: "1146128145"
      },

      
        {
        type: "video",
        title: "Flip Pour Method",
        vimeo: "1146128218"
      },
      

      {
        type: "poll",
        title: " Pick Your Favorite Method",
        question: "Which method will you try first?",
        options: ["Dirty Pour", "Dutch Pour", "Puddle Pour", "Swirl Pour", "Swipe Pour", "Flip Pour"]
      },

      {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/12.png?v=1767179531"
     },

      {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/13.png?v=1767179531"
     },
     
       {
        type: "video",
        title: "Seal Your Coasters",
        vimeo: "1146125857"
      },

      
      {
      type: "image",
      title: "",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/14.png?v=1767179532"
     },

      {
        type: "review",
        title: "Your Thoughts",
        question: "How was this kit for you?"
      }
    ]
  },

pourmetallic: {
   title: "Sunset Swirls",
    theme: {
      cardBg: "#ffffffff",
      buttonBg: "#f8df61",
      buttonText: "#000000ff",
      buttonBorder: "#ffffffff",
      // accent: "#ccf123ff"
      
    },
    slides: [
      {
        type: "video",
        title: "What‚Äôs in the kit?",
        vimeo: "1150611082"
      },

       {
        type: "video",
        title: "Do‚Äôs and Don‚Äôts",
        vimeo: "1146128246"
      },

        {
      type: "image",
      title: "Pour Painting Methods Preview",
      src: "https://cdn.shopify.com/s/files/1/0739/8781/7689/files/pour_painting_set.png?v=1759386296"
     },


       {
        type: "video",
        title: " Dirty Pour Method",
        vimeo: "1146128092"
      },

       {
        type: "video",
        title: "Dutch Pour Method",
        vimeo: "1146128121"
      },
 {
        type: "poll",
        title: " Pick Your Favorite Method",
        question: "Tell us which pouring style you enjoyed the most.22",
        options: ["Dirty Pour", "Dutch Pour", "Puddle Pour", "Swirl Pour", "Swipe Pour", "Flip Pour"]
      },

      {
        type: "video",
        title: "Puddle Pour Method",
        vimeo: "1146128145"
      },

      {
        type: "video",
        title: "Swirl Pour",
        vimeo: "1146128166"
      },

       {
        type: "poll",
        title: " Pick Your Favorite Method",
        question: "Tell us which pouring style you enjoyed the most.11",
        options: ["Dirty Pour", "Dutch Pour", "Puddle Pour", "Swirl Pour", "Swipe Pour", "Flip Pour"]
      },



      {
        type: "video",
        title: "Swipe Pour Method",
        vimeo: "1146128197"
      },

        {
        type: "video",
        title: "Flip Pour Method",
        vimeo: "1146128218"
      },
      

      {
        type: "poll",
        title: " Pick Your Favorite Method",
        question: "Tell us which pouring style you enjoyed the most.",
        options: ["Dirty Pour", "Dutch Pour", "Puddle Pour", "Swirl Pour", "Swipe Pour", "Flip Pour"]
      },

       {
        type: "video",
        title: "Seal Your Coasters",
        vimeo: "1146125857"
      },

      {
        type: "review",
        title: "Your Thoughts",
        question: "How was this kit for you?"
      }
    ]
  },



  // slug: {
  //   theme: {
  //     cardBg: "card bg color here",
  //     buttonBg: "poll button bg color here",
  //     buttonText: "poll button text color here",
  //     accent: "border color here"
  //   },
  //   slides: [
  //     {
  //       type: "video",
  //       title: "title here",
  //       vimeo: "vimeo id here"
  //     },
      
  //     {
  //     type: "image",
  //     title: "image title here",
  //     src: "image link here"
  //    },

  //     {
  //       type: "poll",
  //       title: "Quick Question",
  //       question: "question here",
  //       options: ["opt1", "opt2", "opt3", "opt4"]
  //     },
  //     {
  //       type: "review",
  //       title: "Your Thoughts",
  //       question: "review page question here"
  //     }
  //   ]
  // },

};

/* ======================
   READ KIT FROM URL ‚úÖ
====================== */

const params = new URLSearchParams(window.location.search);
const kitKey = params.get("kit");

if (!kitKey || !kitConfig[kitKey]) {
  document.body.innerHTML =
    "<h2 style='text-align:center;margin-top:40px'>Invalid or missing kit</h2>";
  throw new Error("Invalid kit");
}

const kit = kitConfig[kitKey];

/* ======================
   STATE
====================== */

let index = 0;
let selectedStars = 0;

/* ======================
   ELEMENTS
====================== */



const frame = document.getElementById("videoFrame");
const imageSlide = document.getElementById("imageSlide");
const imageSlideImg = document.getElementById("imageSlideImg");

const pollBox = document.getElementById("pollBox");
const pollQ = document.getElementById("pollQuestion");
const pollOpts = document.getElementById("pollOptions");

const reviewBox = document.getElementById("reviewBox");
const reviewQ = document.getElementById("reviewQuestion");
const reviewText = document.getElementById("reviewText");
const stars = document.querySelectorAll("#starGroup span");

const progress = document.getElementById("progressText");
const card = document.getElementById("videoCard");

const nextBtn = document.getElementById("nextBtn");
const prevBtn = document.getElementById("prevBtn");


/* ======================
   APPLY THEME
====================== */

card.style.background = kit.theme.cardBg;
card.style.boxShadow = `0 0 0 2px ${kit.theme.accent}`;
progress.style.border = `1px solid ${kit.theme.accent}`;

/* ======================
   STAR LOGIC
====================== */

stars.forEach(star => {
  star.onclick = () => {
    selectedStars = Number(star.dataset.star);
    stars.forEach(s =>
      s.classList.toggle("active", Number(s.dataset.star) <= selectedStars)
    );
  };
});

/* ======================
   RENDER
====================== */

function render() {
  const slide = kit.slides[index];

  progress.innerText = `${slide.title} ‚Äì ${index + 1} / ${kit.slides.length}`;

  frame.style.display = "none";
  imageSlide.style.display = "none";
  pollBox.style.display = "none";
  reviewBox.style.display = "none";


  if (slide.type === "video") {
    frame.style.display = "block";
    frame.src = `https://player.vimeo.com/video/${slide.vimeo}`;
  }

  if (slide.type === "image") {
  imageSlide.style.display = "flex";
  imageSlideImg.src = slide.src;
}


  if (slide.type === "poll") {
    pollBox.style.display = "flex";
    pollQ.innerText = slide.question;
    pollOpts.innerHTML = "";

    slide.options.forEach(opt => {
      const btn = document.createElement("button");
      btn.className = "poll-option";
      btn.innerText = opt;

      btn.style.background = kit.theme.buttonBg;
      btn.style.color = kit.theme.buttonText;
      btn.style.border = `2px solid ${kit.theme.buttonBorder || kit.theme.accent || "#000"}`;


      btn.onclick = () => {
        // 1Ô∏è‚É£ Disable all options to prevent double click
        const allButtons = pollOpts.querySelectorAll(".poll-option");
        allButtons.forEach(b => (b.disabled = true));

        // 2Ô∏è‚É£ Visual confirmation
        btn.style.background = "#ffffff";          // contrast
        btn.style.color = "#000000";        // highlight
        btn.style.border = `1px solid ${kit.theme.accent}`;
        btn.style.transform = "scale(1.03)";


        // 3Ô∏è‚É£ Save poll
        const email = localStorage.getItem("hoblie_email");

        const formData = new FormData();
        formData.append("type", "poll");
        formData.append("kit", kitKey);
        formData.append("email", email);
        formData.append("question", slide.question);
        formData.append("answer", opt);

        fetch("https://script.google.com/macros/s/AKfycbx5-uexbnTrfwTAAahumOlbi1ip_mRPvEOKdVdUTEfFar8UK3afjxg5AaJdDsGCz9Yq/exec", {
          method: "POST",
          body: formData
        }).catch(() => {});

        setTimeout(() => {
          index++;
          render();
        }, 400);
      };


      pollOpts.appendChild(btn);
    });
  }

if (slide.type === "review") {
  reviewBox.style.display = "flex";
  reviewQ.innerText = slide.question;

  // ‚úÖ Force textarea placeholder to render correctly
  requestAnimationFrame(() => {
    reviewText.value = "";       // ensure empty
    reviewText.blur();           // reset focus
    reviewText.style.display = "none";
    reviewText.offsetHeight;     // force reflow
    reviewText.style.display = "block";
  });
}


    /* ======================
     REVIEW END STATE for arrow btn
  ====================== */

  if (slide.type === "review") {
    nextBtn.style.display = "none"; // no next on review
    // prevBtn.style.display = "none"; // optional: lock review as final
  } else {
    nextBtn.style.display = "block";
    // prevBtn.style.display = "block";
  }

}

/* ======================
   NAV
====================== */

document.getElementById("nextBtn").onclick = () => {
  if (index < kit.slides.length - 1) {
    index++;
    render();
  }
};

document.getElementById("prevBtn").onclick = () => {
  if (index > 0) {
    index--;
    render();
  }
};

/* ======================
   REVIEW SUBMIT
====================== */

document.getElementById("reviewSubmit").onclick = () => {
  const email = localStorage.getItem("hoblie_email");
  const review = reviewText.value.trim();

  if (!email) {
    alert("Email not found. Please restart from kit page.");
    return;
  }

  const formData = new FormData();
  formData.append("type", "review");
  formData.append("kit", kitKey);
  formData.append("email", email);
  formData.append("stars", selectedStars);
  formData.append("review", review);

  fetch("https://script.google.com/macros/s/AKfycbx5-uexbnTrfwTAAahumOlbi1ip_mRPvEOKdVdUTEfFar8UK3afjxg5AaJdDsGCz9Yq/exec", {
    method: "POST",
    body: formData
  }).catch(() => {});

// alert("Thank you for your feedback ‚ù§Ô∏è");
document.getElementById("successScreen").style.display = "flex";
// hide nav buttons when success page opens
document.querySelector(".nav-controls").style.display = "none";
document.querySelector(".back-btn").style.display = "none";


// get kit name
const kitName = kit.title || kitKey;

// update success quirky message (edit if you want a single line)
const msgEl = document.getElementById("successMessageText");
msgEl.innerText = `Show off your ${kitName} & inspire others ‚ú®`;

// build WhatsApp Share Link
const shareMsg = `I just finished my ${kitName} from Hoblie ‚Äì such a fun and relaxing session!`;
const urlMsg = encodeURIComponent(shareMsg);
const phone = "919016028218"; // ‚Üê PUT YOUR NUMBER HERE
document.getElementById("shareBtn").href =
  `https://api.whatsapp.com/send/?phone=${phone}&text=${urlMsg}&type=custom_url&app_absent=0`;
};


/* ======================
   INIT
====================== */

render(
  
);
